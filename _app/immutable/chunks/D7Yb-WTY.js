import{t as it,a as lt}from"./D0olhUvi.js";import"./1fWIjdlx.js";import{a8 as st,v as S,a9 as ct,aa as mt,a7 as pt,c,ab as ft,f as l,ac as dt,s as _,ad as E,a3 as M,ae as L,r as m}from"./Dxt62XMo.js";import{s as ut}from"./ufU7u_KI.js";import{r as Y}from"./BxuMG8tz.js";import{c as Q,b as gt}from"./CNuWzhWm.js";import{b as vt}from"./NLylHng5.js";import{i as ht}from"./BjSHy-Xe.js";import{p as u}from"./C_8fVN5o.js";import{o as bt}from"./Bd8YvDJK.js";import{c as _t}from"./nHqQ5mnR.js";import{s as U}from"./CB6J5KXz.js";import{b as X}from"./tK10Cjh8.js";import{m as xt}from"./DBeXZoyG.js";import{s as yt}from"./uWTSG2Kf.js";import{c as wt}from"./C4zzdlvu.js";import{a as At}from"./BpUo07YV.js";import{s as Z}from"./DFJOuHom.js";import{R as Tt}from"./CvtXWHAS.js";var Ct=it('<div style="text-align:center; margin-bottom: 0.5rem;"><label><input type="radio"> Count</label> <label style="margin-left: 1rem;"><input type="radio"> Acres</label></div> <div style="text-align: center; margin-bottom: 1rem;"><label>Top N Counties: <input type="number" min="1" max="58"></label></div> <div style="position: relative;"><div style="overflow-x: auto; overflow-y: auto; max-width: 100%; max-height: 800px; margin: auto;"></div> <div class="year-label svelte-27ydg6"><strong> </strong></div></div>',1);function Jt(O,p){st(p,!1);const k=[];let $=u(p,"csvPath",8,"/fire_points_updated.csv"),g=u(p,"initialStartYear",8,1992),x=u(p,"initialEndYear",8,2020),tt=u(p,"initialTopN",8,10),N=u(p,"progress",8,0),y=S(),P=[],v=[],w=S([]),h=S(tt()),s=u(p,"metric",12,"count");const f=60,b=20;let q=S(g());bt(async()=>{P=await wt($(),t=>({county:t.county,year:+t.year,acres:+t.acres||0})),E(w,Array.from(new Set(P.map(t=>t.year))).filter(t=>t>=g()&&t<=x()).sort((t,e)=>t-e))});function at(t){const e=P.filter(r=>t.includes(r.year)),d=At(e,r=>s()==="count"?r.length:U(r,i=>i.acres),r=>r.county).sort((r,i)=>i[1]-r[1]).slice(0,l(h)).map(r=>r[0]);v=[],t.forEach(r=>{d.forEach(i=>{const C=s()==="count"?e.filter(n=>n.county===i&&n.year===r).length:U(e.filter(n=>n.county===i&&n.year===r),n=>n.acres);v.push({county:i,year:r,fire_count:C})})}),rt(d,t)}function et(t){const e=_t(t);return e?(e.r*299+e.g*587+e.b*114)/1e3>128?"#000":"#fff":"#000"}function rt(t,e){Z(l(y)).selectAll("*").remove();const o={top:80,right:20,bottom:40,left:80},d=o.left+o.right+f*t.length,r=o.top+o.bottom+b*e.length,i=Z(l(y)).append("svg").attr("width",d).attr("height",r),C=i.append("g").attr("transform",`translate(${o.left},${o.top})`),n=X().domain(t).range([0,f*t.length]).padding(.1),D=X().domain(e).range([0,b*e.length]),nt=xt(v,a=>a.fire_count),K=yt().domain([0,nt]).interpolator(Tt);C.selectAll("rect").data(v).enter().append("rect").attr("x",a=>n(a.county)).attr("y",a=>D(a.year)).attr("width",f).attr("height",b).style("fill",a=>K(a.fire_count)).style("stroke","#fff"),C.selectAll("text.cell").data(v).enter().append("text").attr("class","cell").attr("x",a=>n(a.county)+f/2).attr("y",a=>D(a.year)+b/2).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("font-size","12px").attr("fill",a=>et(K(a.fire_count))).text(a=>a.fire_count>0?Math.round(a.fire_count):""),i.append("g").attr("transform",`translate(${o.left},${o.top-10})`).selectAll("text").data(t).enter().append("text").attr("x",a=>n(a)+f/2).attr("y",0).attr("text-anchor","start").attr("transform",a=>`rotate(-45, ${n(a)+f/2}, 0)`).attr("font-weight","bold").attr("font-size","12px").text(a=>a),i.append("g").attr("transform",`translate(${o.left-10},${o.top})`).selectAll("text").data(e).enter().append("text").attr("x",-5).attr("y",a=>D(a)+b/2).attr("text-anchor","end").attr("dominant-baseline","middle").attr("font-weight","bold").attr("font-size","12px").text(a=>a)}ct(()=>(l(h),M(s()),l(w),M(N()),M(x()),M(g())),()=>{if((l(h)||s())&&l(w).length&&N()>=12){const t=N()-12,o=Math.floor(t/88*(x()-g())),d=l(w).slice(0,o+1);E(q,Math.min(x(),g()+o)),at(d)}}),mt(),ht();var V=Ct(),z=pt(V),H=c(z),A=c(H);Y(A),A.value=(A.__value="count")==null?"":"count",L(),m(H);var W=_(H,2),T=c(W);Y(T),T.value=(T.__value="acres")==null?"":"acres",L(),m(W),m(z);var R=_(z,2),j=c(R),B=_(c(j));Y(B),m(j),m(R);var F=_(R,2),G=c(F);vt(G,t=>E(y,t),()=>l(y));var I=_(G,2),J=c(I),ot=c(J,!0);m(J),m(I),m(F),ft(()=>ut(ot,l(q))),Q(k,[],A,s,s),Q(k,[],T,s,s),gt(B,()=>l(h),t=>E(h,t)),lt(O,V),dt()}export{Jt as C};
